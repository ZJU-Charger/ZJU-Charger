# <img src="assets/logo_white.png" alt="logo" width="30"> ğ™ğ‰ğ” ğ‚ğ¡ğšğ«ğ ğğ«

![Star Badge](https://img.shields.io/github/stars/Phil-Fan/ZJU-Charger?style=social) ![License Badge](https://img.shields.io/github/license/Phil-Fan/ZJU-Charger) ![Contributors Badge](https://img.shields.io/github/contributors/Phil-Fan/ZJU-Charger) ![Issues Badge](https://img.shields.io/github/issues/Phil-Fan/ZJU-Charger) ![Pull Requests Badge](https://img.shields.io/github/issues-pr/Phil-Fan/ZJU-Charger) ![Last Commit Badge](https://img.shields.io/github/last-commit/Phil-Fan/ZJU-Charger) ![Code Size Badge](https://img.shields.io/github/languages/code-size/Phil-Fan/ZJU-Charger)

[![Markdown Quality Check](https://github.com/Phil-Fan/ZJU-Charger/actions/workflows/markdown-check.yml/badge.svg)](https://github.com/Phil-Fan/ZJU-Charger/actions/workflows/markdown-check.yml) [![Python (Ruff Action)](https://github.com/Phil-Fan/ZJU-Charger/actions/workflows/python-check.yml/badge.svg)](https://github.com/Phil-Fan/ZJU-Charger/actions/workflows/python-check.yml) [![pages-build-deployment](https://github.com/Phil-Fan/ZJU-Charger/actions/workflows/pages/pages-build-deployment/badge.svg)](https://github.com/Phil-Fan/ZJU-Charger/actions/workflows/pages/pages-build-deployment)

![logo](assets/logo.gif)

ä½ æ˜¯å¦ä¹Ÿæ›¾éª‘ç€æ²¡ç”µçš„å°é¾Ÿï¼Œæ…¢åååœ°éª‘åˆ°å……ç”µæ¡©ï¼Œå´å‘ç°ä¸€ä¸ªç©ºä½™çš„æ¡©ä½éƒ½æ²¡æœ‰ï¼ŸğŸ˜«
ä½ æ˜¯å¦ä¹Ÿæ›¾è¢«å……ç”µæ¡©æœåŠ¡å•†ç¦»è°±çš„ UI ç•Œé¢ä¸å¤æ‚çš„æŸ¥è¯¢æ¥å£æ‰€å›°æ‰°ï¼ŸğŸ˜ 

ZJU Charger åŸºäº FastAPI å¼€å‘ï¼Œç„å‡†**æ ¡å†…å……ç”µæ¡©ä¸å¥½æ‰¾ã€ä¾›åº”å•†å…¥å£ä¸ä¸€ã€ä½¿ç”¨çŠ¶æ€æŸ¥è¯¢ä¸ä¾¿**ä¸‰å¤§ç—›ç‚¹ï¼Œä¸ºä½ æä¾›ä¸€ä¸ªç®€æ´ã€æ˜“ç”¨ã€æ‰©å±•æ€§å¼ºçš„å……ç”µæ¡©æŸ¥è¯¢æ–¹æ¡ˆã€‚

ç›®å‰æ”¯æŒç½‘ç«™åœ¨çº¿åˆ†æ ¡åŒºã€åˆ†æœåŠ¡å•†æŸ¥è¯¢ï¼ˆæ™®æŸ¥ï¼‰ã€iOS å¿«æ·æŒ‡ä»¤æŸ¥è¯¢ç‰¹å®šç«™ç‚¹çŠ¶æ€ï¼ˆç²¾å‡†æŸ¥ï¼‰ã€é’‰é’‰ Webhook æœºå™¨äººç­‰åŠŸèƒ½ã€‚

è®¿é—® [https://charger.philfan.cn/](https://charger.philfan.cn/) æŸ¥çœ‹æ•ˆæœã€‚

> **å…è´£å£°æ˜**ï¼šæœ¬é¡¹ç›®ä»…ç”¨äºå­¦ä¹ äº¤æµï¼Œä¸å¾—ç”¨äºå•†ä¸šç›ˆåˆ©ä¸éæ³•ç”¨é€”ã€‚ä½¿ç”¨æœ¬é¡¹ç›®æ‰€é€ æˆçš„ä»»ä½•åæœï¼Œç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…ï¼Œä½œè€…ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚è¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ã€‚

## News

- 2025.12.02 - é‡æ„å‰ç«¯ UI æ”¯æŒå°¼æ™®é¡¿æ™ºæ…§ç”Ÿæ´»å…¬ä¼—å·æŸ¥è¯¢
- 2025.11.30 - GitHub è¾¾åˆ° 50 Starï¼Œæ„Ÿè°¢æ”¯æŒï¼[æ ¡å†…å…¬ä¼—å·å®£ä¼ è´´](https://mp.weixin.qq.com/s/8tX1yHx_uvv64XQashPpTA)
- 2025.12.01 - æ”¯æŒ iOS å¿«æ·æŒ‡ä»¤ï¼Œå¢åŠ åå®¶æ± æ ¡åŒº [CC98 å®£ä¼ è´´](https://www.cc98.org/topic/6359446)ï¼ˆåå¤§ï¼‰
- 2025.11.29 - å®Œæˆåç«¯é¡µé¢å¼€å‘ï¼Œç½‘ç«™ä¸Šçº¿ [CC98 å®£ä¼ è´´](https://www.cc98.org/topic/6357576)ï¼ˆåå¤§ç¬¬ä¸€ï¼‰
- 2025.11.28 - å‘ç°è„šæœ¬ï¼Œåˆ¶ä½œå¯è§†åŒ– [CC98 å®£ä¼ è´´](https://www.cc98.org/topic/6357005)

## åŠŸèƒ½ç‰¹æ€§

### å‰ç«¯åŠŸèƒ½

Next.js æ¡†æ¶å¼€å‘ï¼šApp Router + TypeScript + shadcn/ui, å¼€æºåœ¨ [Phil-Fan/zju-charger-frontend](https://github.com/Phil-Fan/zju-charger-frontend) è¿™ä¸ªä»“åº“ã€‚

- [x] Apache ECharts + `echarts-extension-amap` æä¾›é«˜å¾·åœ°å›¾æœåŠ¡ã€‚
- [x] æ”¯æŒä¸‰æ ¡åŒºåœ°å›¾åˆ‡æ¢/æœåŠ¡å•†ç­›é€‰ã€‚ã€‚
  ![campus_01](assets/campus_01.png)
  ![campus_02](assets/campus_02.png)
  ![campus_03](assets/campus_03.png)
- [x] ç»¿/æ©™/çº¢ä¸‰è‰²ç¼–ç ç©ºé—²ã€ç´§å¼ ã€æ•…éšœçŠ¶æ€ã€‚
- [x] åŒå‡»ç«™ç‚¹æ‰“å¼€å¯¼èˆªå¡ç‰‡ï¼Œæ”¯æŒé«˜å¾·åœ°å›¾å’Œç³»ç»Ÿåœ°å›¾ã€‚
  ![navigate](assets/navigate.png)
- [x] æ”¯æŒå®æ—¶å®šä½ï¼Œå¼€å¯åæŒç»­è¿½è¸ªæµè§ˆå™¨åæ ‡ã€ç»˜åˆ¶ç”¨æˆ·æ ‡è®°ã€‚
- [x] å…³æ³¨åˆ—è¡¨é€šè¿‡ localStorage å®ç°ã€‚
  ![watchlist](assets/watchlist.png)
- [x] ç•Œé¢ä¸åœ°å›¾åŒæ—¶æ”¯æŒæš—é»‘æ¨¡å¼ã€‚
  ![light](assets/web_light.png)
  ![dark](assets/web_dark.png)
- [x] å‰ç«¯å®šæ—¶è‡ªåŠ¨åˆ·æ–°ã€‚
- [x] å¤œé—´æç¤ºã€‚

### åç«¯åŠŸèƒ½

- [x] FastAPI ç»Ÿä¸€ API æ¥å£ï¼Œä½¿ç”¨ slowapi å®ç°æ¥å£é™æµåŠŸèƒ½
- [x] å¤šæœåŠ¡å•†æ¶æ„æ”¯æŒï¼Œå¯åŒæ—¶å¼‚æ­¥æŠ“å–å¤šä¸ªæœåŠ¡å•†çš„å……ç”µæ¡©æ•°æ®ï¼ˆç›®å‰æ”¯æŒäº†å°¼æ™®é¡¿æœåŠ¡å•†ï¼‰
- [x] åå°å®šæ—¶æŠ“å–ä»»åŠ¡ï¼Œè‡ªåŠ¨æ›´æ–°ç¼“å­˜
- [x] Supabase æ•°æ®åº“æ”¯æŒï¼Œè®°å½•å†å²ä½¿ç”¨æƒ…å†µæ•°æ®ï¼ˆå¯é€‰ï¼‰

### å¿«æ·æŒ‡ä»¤

[ZJU Charger.shortcut](https://www.icloud.com/shortcuts/1545aeee457046dbacba42ef0ab6285d)

æ”¯æŒå¿«é€ŸæŸ¥è¯¢å…³æ³¨çš„å‡ ä¸ªç«™ç‚¹çš„çŠ¶æ€ï¼Œå¹¶å¯ä»¥æ·»åŠ åˆ°ä¸»å±å¹•ï¼Œæ–¹ä¾¿éšæ—¶æŸ¥çœ‹ã€‚
æ“ä½œæ­¥éª¤è¯¦è§ [Script å¿«æ·æŒ‡ä»¤æ–‡æ¡£](./docs/06-script-shortcuts.md#ä½¿ç”¨æ–¹æ³•)ã€‚

![shortcut](assets/shortcut_result.jpg)

### é’‰é’‰ Webhook æœºå™¨äºº

![dingbot](assets/dingbot.png)

## æ–‡æ¡£

è¯¦ç»†çš„æ–‡æ¡£è¯·æŸ¥çœ‹ [docs](./docs/) ç›®å½•ï¼š

- [å¿«é€Ÿå¼€å§‹](./docs/01-quick-start.md) - å¿«é€Ÿä¸Šæ‰‹æŒ‡å—
- [Web ä»‹ç»ä¸éƒ¨ç½²](./docs/02-web-deployment.md) - å‰ç«¯åŠŸèƒ½è¯´æ˜å’Œéƒ¨ç½²æŒ‡å—
- [Server ç«¯éƒ¨ç½²](./docs/03-server-deployment.md) - åç«¯æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—
- [Fetcher æ–‡æ¡£](./docs/04-fetcher.md) - å¦‚ä½•æ·»åŠ æ–°æœåŠ¡å•†ã€æ›´æ–°ç«™ç‚¹ä¿¡æ¯
- [é’‰é’‰æœºå™¨äººæ–‡æ¡£](./docs/05-dingbot.md) - é’‰é’‰æœºå™¨äººé…ç½®å’Œä½¿ç”¨
- [Script å¿«æ·æŒ‡ä»¤æ–‡æ¡£](./docs/06-script-shortcuts.md) - iOS å¿«æ·æŒ‡ä»¤ä½¿ç”¨æŒ‡å—
- [Supabase æ•°æ®åº“æ¶æ„](./docs/07-supabase-schema.md) - Supabase æ•°æ®åº“è¡¨ç»“æ„å’Œä½¿ç”¨è¯´æ˜
- [API å‚è€ƒ](./docs/08-api.md) - åç«¯ REST API æè¿°ä¸ç¤ºä¾‹

### ç³»ç»Ÿæ¶æ„

åœ¨å¼€å‘å±‚é¢ï¼Œç›®æ ‡å®ç°é«˜å†…èšã€ä½è€¦åˆã€æ˜“äºæ‰©å±•ã€‚

```mermaid
flowchart TD

    A["iOS å¿«æ·æŒ‡ä»¤<br/>1. å…³æ³¨ç‚¹å¿«é€ŸæŸ¥è¯¢"]

    B["Next.js Web App<br/>App Router"]

    C["FastAPI API æœåŠ¡"]

    D["é’‰é’‰æœºå™¨äºº<br/>å…¨éƒ¨"]

    E["ProviderManager<br/>æœåŠ¡å•†ç®¡ç†å™¨"]

    F1["NeptuneProvider<br/>å°¼æ™®é¡¿æœåŠ¡å•†"]
    F2["å…¶ä»–æœåŠ¡å•†<br/>å¯æ‰©å±•..."]

    G["Supabase æ•°æ®åº“"]

    %% è¿æ¥å…³ç³»
    A --> |æŸ¥è¯¢| C

    B <--> |AJAX| C

    D --> |webhook| C

    C --> |è¯»å–æ•°æ®| G
    E --> |ç®¡ç†| F1
    E --> |ç®¡ç†| F2
    F1 --> |å®æ—¶æŠ“å–| E
    F2 --> |å®æ—¶æŠ“å–| E
    
    G <--> |å†™å…¥ç¼“å­˜| E
```

æ‰€æœ‰æŸ¥è¯¢æ¥æºï¼ˆReact Web SPAã€é’‰é’‰ã€GitHub Actionï¼‰éƒ½è°ƒç”¨ç»Ÿä¸€ API å’Œ ProviderManagerï¼Œé€»è¾‘å®Œå…¨ä¸é‡å¤ã€‚

å‰ç«¯é€šè¿‡ Vite æ„å»ºçš„ React + Apache ECharts-on-AMap å®¢æˆ·ç«¯æ¶ˆè´¹è¿™äº› APIï¼Œç³»ç»Ÿåˆ™ä¿æŒå¤šæœåŠ¡å•†æ¶æ„ä»¥æ”¯æŒå¹¶å‘ç­›é€‰ã€‚

### é¡¹ç›®ç»“æ„

```text
project/
â”œâ”€â”€ fetcher/
â”‚   â”œâ”€â”€ provider_manager.py   # æœåŠ¡å•†ç®¡ç†å™¨
â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â”œâ”€â”€ provider_base.py  # æœåŠ¡å•†æŠ½è±¡åŸºç±»
â”‚   â”‚   â””â”€â”€ neptune.py        # å°¼æ™®é¡¿æœåŠ¡å•†å®ç°
â”‚   â””â”€â”€ station.py            # å…±äº« Station æ¨¡å‹ï¼ˆCSV è§£æ + hash ç”Ÿæˆï¼‰
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ client.py             # Supabase å®¢æˆ·ç«¯åˆå§‹åŒ–
â”‚   â”œâ”€â”€ station_repo.py       # stations è¡¨ CRUD
â”‚   â”œâ”€â”€ usage_repo.py         # latest/usage è¡¨è¯»å†™
â”‚   â”œâ”€â”€ pipeline.py           # record_usage_data æ•°æ®ç®¡é“
â”‚   â””â”€â”€ __init__.py           # ç»Ÿä¸€æš´éœ² initialize/get/batch æ¥å£
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ api.py                # FastAPI ä¸»æœåŠ¡ï¼ˆç›´æ¥è°ƒç”¨ db/ ä»“åº“ï¼‰
â”‚   â”œâ”€â”€ config.py             # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆæ”¯æŒæœåŠ¡å•†é…ç½®ï¼‰
â”‚   â”œâ”€â”€ run_server.py         # æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ logging_config.py     # æ—¥å¿—é…ç½®
â”œâ”€â”€ ding/
â”‚   â”œâ”€â”€ bot.py                # é’‰é’‰æœºå™¨äººå°è£…
â”‚   â”œâ”€â”€ webhook.py            # é’‰é’‰ webhook è·¯ç”±
â”‚   â””â”€â”€ commands.py           # å‘½ä»¤è§£æå’Œæ‰§è¡Œ
â”œâ”€â”€ frontend/                 # Next.js + shadcn å‰ç«¯
â”‚   â”œâ”€â”€ package.json          # pnpm scriptsã€ä¾èµ–ã€biome é…ç½®
â”‚   â”œâ”€â”€ src/app/              # Next App Router é¡µé¢ã€layoutã€é”™è¯¯é¡µ
â”‚   â”œâ”€â”€ src/components/       # shadcn ui + ä¸šåŠ¡ç»„ä»¶ï¼ˆHeader/Map/List ç­‰ï¼‰
â”‚   â””â”€â”€ src/lib|hooks|types   # æ ¡åŒºé…ç½®ã€API å®¢æˆ·ç«¯ã€çŠ¶æ€ hooksã€åæ ‡å·¥å…·
â”œâ”€â”€ script/                   # iOS å¿«æ·æŒ‡ä»¤
â”‚   â”œâ”€â”€ README.md             # å¿«æ·æŒ‡ä»¤ä½¿ç”¨è¯´æ˜
â”‚   â””â”€â”€ *.shortcut            # å¿«æ·æŒ‡ä»¤æ–‡ä»¶
â”œâ”€â”€ serve.sh                  # å¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼ˆåŸºäº uv åŒæ­¥ä¾èµ–å¹¶è°ƒç”¨ server.run_serverï¼‰
â”œâ”€â”€ pyproject.toml            # Python ä¾èµ–å£°æ˜ + uv/Ruff é…ç½®
â””â”€â”€ uv.lock                   # uv ç”Ÿæˆçš„é”å®šæ–‡ä»¶
```

## è®¸å¯è¯

ä½¿ç”¨ GPLv3 è®¸å¯è¯ï¼Œè§ [LICENSE](./LICENSE) æ–‡ä»¶

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

è¯·æŸ¥çœ‹ï¼š

- [è¡Œä¸ºå‡†åˆ™](./CODE_OF_CONDUCT.md)
- [è´¡çŒ®æŒ‡å—](./CONTRIBUTING.md)
- [Issue æ¨¡æ¿](./.github/ISSUE_TEMPLATE/)
- [Pull Request æ¨¡æ¿](./.github/pull_request_template.md)

![star history](https://api.star-history.com/svg?repos=Phil-Fan/ZJU-Charger&type=Date)

## è‡´è°¢

### åç«¯

- æ„Ÿè°¢ [cyc-987/Charge-in-ZJU: æµ™å¤§å……ç”µæ¡©æŸ¥è¯¢](https://github.com/cyc-987/Charge-in-ZJU) çš„åŸä½œè€… [@cyc-987](https://github.com/cyc-987)ï¼Œä¸ºé¡¹ç›®æä¾›çµæ„Ÿï¼›æ„Ÿè°¢ [ç´«é‡‘æ¸¯å……ç”µæ¡©åœ°å›¾ - CC98 è®ºå›](https://www.cc98.org/topic/6348814) ä¸­åˆ†äº«çš„ ZJG å……ç”µåœ°å›¾ï¼›æ„Ÿè°¢ [æµ™æ±Ÿå¤§å­¦ E æ ¡å›­ç”µå­åœ°å›¾å¹³å°](https://map.zju.edu.cn/index?locale=en_US) ä¸­çš„éƒ¨åˆ†å……ç”µæ¡©ç‚¹ä½ä¿¡æ¯ã€‚
- ä½¿ç”¨ [ç»çº¬åº¦æŸ¥è¯¢å®šä½ ï½œ åæ ‡æ‹¾å–](https://www.mapchaxun.cn/Regeo) è°ƒæ•´æŠ“å–åˆ°çš„é”™è¯¯ç«™ç‚¹åæ ‡ã€‚
- ä½¿ç”¨ [fastapi](https://fastapi.tiangolo.com/) å®ç° API æœåŠ¡ï¼›ä½¿ç”¨ [slowapi](https://github.com/sunhailin-dev/slowapi) å®ç°æ¥å£é™æµåŠŸèƒ½ã€‚
- ä½¿ç”¨ [supabase](https://supabase.com/) å®ç°æ•°æ®åº“åŠŸèƒ½ã€‚
- ä½¿ç”¨ [Caddy](https://caddyserver.com/) å®ç° HTTPS è¯ä¹¦ä¸åå‘ä»£ç†æœåŠ¡ã€‚

### å‰ç«¯

- ä½¿ç”¨ [Next.js](https://nextjs.org/) å®ç°å‰ç«¯æ¡†æ¶ã€‚
- ä½¿ç”¨ [é«˜å¾·åœ°å›¾ Web JS SDK](https://console.amap.com/dev/index) å®ç°åœ°å›¾æ¸²æŸ“ã€‚
- ä½¿ç”¨ [Apache ECharts](https://echarts.apache.org/) + [echarts-extension-amap](https://github.com/plainheart/echarts-extension-amap) å®Œæˆåœ°å›¾æ¸²æŸ“ã€‚
- ä½¿ç”¨ [Apple URL Scheme - Map Links](https://developer.apple.com/library/archive/featuredarticles/iPhoneURLScheme_Reference/MapLinks/MapLinks.html) ä¸ [é«˜å¾·åœ°å›¾æ‰‹æœºç‰ˆ API - è·¯å¾„è§„åˆ’](https://lbs.amap.com/api/amap-mobile/guide/android/navigation) å®ç°åœ°å›¾è·³è½¬ã€‚
- ä½¿ç”¨ [shadcn/ui](https://ui.shadcn.com/) å®ç°ç»„ä»¶åº“ï¼Œä½¿ç”¨ [tweakcn](https://tweakcn.com/editor/theme) ç”Ÿæˆ Supabase ä¸»é¢˜ã€‚
- ä½¿ç”¨ [Biome](https://biomejs.dev/) å®ç°ä»£ç æ£€æŸ¥ä¸æ ¼å¼åŒ–ã€‚
- åæ ‡è½¬æ¢ç”±è‡ªå®šä¹‰ `geo` å·¥å…·å®ç°ï¼ˆWGS84 â†” GCJ02 â†” BD09ï¼‰ã€‚

### å…¶ä»–

- ç‰¹åˆ«é¸£è°¢ [@qychen2001](https://github.com/qychen2001) å¯¹é¡¹ç›®çš„å¤§åŠ›æ”¯æŒï¼
- ä½¿ç”¨ [minima](https://github.com/jekyll/minima) ä¸»é¢˜ç”Ÿæˆé¡¹ç›®æ–‡æ¡£ã€‚
- ä½¿ç”¨ [huacnlee/autocorrect](https://github.com/huacnlee/autocorrect/), [DavidAnson/markdownlint-cli2-action](https://github.com/DavidAnson/markdownlint-cli2-action) ä¸ [gaurav-nelson/github-action-markdown-link-check](https://github.com/gaurav-nelson/github-action-markdown-link-check) å¯¹ Markdown æ–‡æ¡£è¿›è¡Œè‡ªåŠ¨åŒ–æ£€æŸ¥ã€‚
- ä½¿ç”¨ [uv](https://docs.astral.sh/uv/) ç®¡ç† Python ä¾èµ–ï¼Œå¹¶ä»¥ [Ruff](https://docs.astral.sh/ruff/) ç»Ÿä¸€å®Œæˆæ ¼å¼åŒ–ä¸ Lintï¼ˆCI é€šè¿‡ [astral-sh/ruff-action](https://github.com/astral-sh/ruff-action) å¹¶è¡Œæ‰§è¡Œ `ruff format --check` ä¸ `ruff check`ï¼‰ã€‚
- ä½¿ç”¨ [jitter.video](https://jitter.video/templates) å®ç° GIF åŠ¨ç”»ã€‚
- ä½¿ç”¨ [Star History](https://star-history.com/) å®ç° star å†å²ç»Ÿè®¡ã€‚
- ä½¿ç”¨ [Google analytics](https://analytics.google.com/) å’Œ [Clarity](https://clarity.microsoft.com/) å®ç°ç½‘ç«™è®¿é—®ç»Ÿè®¡ä¸ç”¨æˆ·ç†è§£ã€‚
- ä½¿ç”¨ [Aliyun ECS](https://www.aliyun.com/product/ecs) å®ç°æœåŠ¡å™¨éƒ¨ç½²ï¼Œä¹Ÿä½¿ç”¨äº† [Vercel](https://vercel.com/) ä¸ [Cloudflare Pages](https://pages.cloudflare.com/) å®ç°é™æ€ç½‘ç«™éƒ¨ç½²ã€‚

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…ï¼

![GitHub contributors](https://contrib.rocks/image?repo=Phil-Fan/ZJU-Charger)
